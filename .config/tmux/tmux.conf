# set shell
set -g default-shell /bin/zsh
set -g default-terminal "xterm-256color"

# general settings
set -g history-limit 10000
set -g mouse on  # Mouse mode

set -sg escape-time 10
set -g focus-events on

# UI settings
##########################################################################
set -g base-index       1   # 窗口编号从 1 开始计数
set -g pane-base-index  1   # 窗格编号从 1 开始计数
set -g renumber-windows on  # 关掉某个窗口后，编号重排

set -g status on
set -g status-interval 1 # 状态栏刷新时间
set -g status-justify left # 状态栏列表左对齐
setw -g monitor-activity on # 非当前窗口有内容更新时在状态栏通知
set -wg window-status-format " #I:#W " # 状态栏窗口名称格式
set -wg window-status-current-format " <#I:#W> " # 状态栏当前窗口名称格式(#I：序号，#w：窗口名称，#F：间隔符)
set -wg window-status-separator "|" # 状态栏窗口名称之间的间隔

set -g status-left "[#S]"
set -g status-right "%Y-%m-%d %H:%M"

# key bindings
##########################################################################
set -g prefix C-s

is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'

bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R


# 绑定hjkl键为面板切换的上下左右键
bind -r k select-pane -U # 绑定k为↑
bind -r j select-pane -D # 绑定j为↓
bind -r h select-pane -L # 绑定h为←
bind -r l select-pane -R # 绑定l为→

# 绑定Ctrl+hjkl键为面板上下左右调整边缘的快捷指令
bind -r ^k resizep -U 5 # 绑定Ctrl+k为往↑调k面板边缘5个单元格
bind -r ^j resizep -D 5 # 绑定Ctrl+j为往↓调整面板边缘5个单元格
bind -r ^h resizep -L 5 # 绑定Ctrl+h为往←调整面板边缘5个单元格
bind -r ^l resizep -R 5 # 绑定Ctrl+l为往→调整面板边缘5个单元格

# 新开窗格后定位在当前目录
bind -r - split-window -v -c '#{pane_current_path}' # hsplit
bind -r = split-window -h -c '#{pane_current_path}' # vsplit

# Easy config reload
bind r source-file ~/.config/tmux/tmux.conf \; display "tmux.conf reloaded"
